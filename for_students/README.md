в общем, наш алгоритм определения двух телефонов не такой уж позорный, и включает в себя аж сколько-то признаков и модель машинного обучения

я смог найти концы, преобразовать данные (чтобы не слить ничьи данные), немного подчистить ноутбуки, чтобы вы могли на своих данных проделать похожие действия
прикрепляю архив, в котором
1. data — папка с исходными и обработанными данными
2. notebooks:
02_prototyping — берет исходные данные, считает фичи на парах (и вообще определяет потенциальные пары), чтобы потом их подавать в модель
03_making_target — то, как мы из исходных данных получали таргеты и обучали модель
04_deviation_report — то, как мы получаем предсказания модели
05...06 — аналогичные ноутбуки, только уже чуть на других данных (third_departure, их тоже прикрепляю)
3. artifacts — модель и ее фичи в нужном порядке
ну и реки с библиотеками (мне удалось все это поставить на python 3.8.11 через анаконду, выше питон поставить скорее всего не выйдет)

   
# Что сделано
Был создан файл 07_data_exploration_preparation.ipynb, 
в этом файле были преобразованы данные третьей отправки,
чтобы они совпадали с внутренним форматом файлов в 
папке второй отправки.

Были переименованы файлы в подпапках директории 
third_departure_parquet_preprocessed/raw 
для согласования имён фалов.

В файле 04_deviation_report была проверена точность
работы алгоритма на всех даных второй отправки.
Полученный результат составил 81%

При применении алгоритма поиска пересечений к данным
третьей отправки
было выявлено, что пользователи в этих данных не 
находятся близко друг к другу.